# Continue Here

**Created:** 2026-02-19 ~21:00
**Task:** Pre-implementation design — brainstorm capture + discuss for first specs
**Branch:** main

## What's Done
- Pivoted architecture from single HTML to Next.js 14 + Vercel Postgres + Drizzle + shadcn/ui + Recharts
- Wrote docs/ARCHITECTURE.md with full tech stack, schema design, API routes, 4-view structure
- Updated CLAUDE.md and TODO.md for new stack
- Scaffolded Next.js project: 4 route pages (overview, explorer, anomalies, process), sidebar nav, entity selector, shadcn/ui components installed
- Wrote Drizzle schema: entities (multi-tenant), claims (596K rows, indexed), drug_info (reference table)
- Wrote seed script (scripts/seed.ts): CSV parsing with BOM handling, batch insert, dedup drug_info
- Verified clean build (npm run build passes, dev server returns 200)
- Created remote repo: github.com/nesnewsnad/SPS_Case_Study
- Pushed all scaffold work

## What's Remaining
- **Brainstorm design doc**: Capture tonight's brainstorm into `docs/plans/2026-02-19-dashboard-design.md` — what's locked, what's still open
- **`/discuss` for first specs**: Lock open design questions (chart types, color palette, KPI calculations, filter UX, narrative tone) before Framework starts implementing
- **Vercel setup**: Link repo to Vercel, create Postgres database, pull env vars, push schema, run seed
- **All implementation**: API routes, chart components, filter system, narrative layer, AI process page
- **All verification**: Every spec needs `/verify` after implementation

## In-Progress State
- No specs written yet — still in pre-spec phase
- No Vercel project created yet (need manual setup in dashboard)
- No database provisioned yet
- Scaffold is complete and builds clean — placeholder cards on all 4 views
- Framework Desktop has not yet cloned the repo

## Decisions Made This Session
- **Architecture pivot**: Single HTML → Next.js + Postgres. Reason: user wants production-grade, multi-entity, day-one deployable. Vercel for live URL.
- **Next.js over Vite**: User wants database + API routes + potential for CSV ingestion pipeline. Next.js App Router gives server components + API in one project.
- **Drizzle over Prisma**: Lighter weight, SQL-close, less abstraction overhead for analytics queries.
- **4 views not 6+**: Brief says "quality over quantity." Executive Overview, Claims Explorer, Anomalies & Insights, AI Process.
- **Multi-entity schema**: entity_id on claims table from day one. Pharmacy A is entity #1. Shows forward thinking per the brief's extension mock-up deliverable.
- **Process gap identified**: We brainstormed organically but skipped the brainstorming skill (should have used `superpowers:brainstorming`) and skipped `/discuss`. Need to capture brainstorm output and run discuss before first spec.

## Open Design Questions (NOT YET LOCKED)
1. Color palette — healthcare professional? SPS Health brand colors? Neutral with accent?
2. Chart types per view — bar vs. line vs. area for monthly trend? Pie vs. horizontal bar for formulary/state?
3. KPI card calculations — which 4 metrics? How computed (net vs. gross)?
4. Filter UX — top bar dropdowns? sidebar filters? pills/chips? Multi-select behavior?
5. Narrative tone — clinical precision? business consultant? executive summary?
6. Anomaly deep-dive format — expanding panels with sub-charts? Side-by-side comparisons?
7. What makes the anomaly analysis actually insightful beyond "here's September by state"?

## Next Action
**Priority 1:** Write brainstorm design doc to `docs/plans/2026-02-19-dashboard-design.md` capturing all locked decisions from tonight's conversation and explicitly listing the 7 open questions above.

**Priority 2:** Run `/discuss` targeting the Executive Overview + Claims Explorer views (the first implementation scope). Lock: chart types, KPI definitions, color palette, filter UX pattern, narrative annotation style. Output to `docs/specs/SPEC-001-context.md`.

**Priority 3:** Set up Vercel project + Postgres database (requires manual browser steps). Then `vercel env pull .env.local`, `npm run db:push`, `npm run db:seed`.

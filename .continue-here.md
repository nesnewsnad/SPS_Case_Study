# Continue Here

**Created**: 2026-02-20, ~5:15 PM (Mac)
**Task**: Production polish pass — Framework completed broad UI pass, remaining gaps identified.
**Branch**: main (clean, up to date with origin)

## What's Done This Session

1. **Opened session** from checkpoint — chat sidebar done, polish remaining.
2. **Fixed x-axis label clipping** on anomaly mini charts — changed rotation threshold to `formattedData.length > 6` (3 commits).
3. **Pulled Framework's polish pass** (27 files) — new fonts (Outfit/JetBrains Mono), dashboard-bg gradient, frosted glass filter bar, unified chart tooltips, KPI top stripes, insight card icons, table refinements, chat sidebar gradient FAB, AI Process section headers/dividers/stat teal coloring, pipeline hover shadows, context layer teal stripes.
4. **Reviewed all changes** and identified remaining gaps.

## What's Remaining

### HIGH PRIORITY — Anomaly Page Internals (untouched by Framework)

These components got zero polish while everything around them was upgraded:

- [ ] **`anomaly-panel.tsx`** — Key stat badge doesn't resize on mobile. Section labels (SectionLabel component) use inconsistent styling vs new page patterns. "To Confirm" and "RFP Impact" callout boxes have `px-4 py-3` while card content uses `px-6` — visual padding imbalance. ChartContainer has mismatched `p-3 pb-5` (should be `p-4`).
- [ ] **`before-after-table.tsx`** — Plain table styling, no visual treatment matching the new tooltip/card aesthetic.
- [ ] **`follow-up-questions.tsx`** — Question list styling is basic. Number circles could match pipeline flow circles. No visual polish applied.
- [ ] **`extension-mockup.tsx`** — Cards are functional but weren't touched in the polish pass. Could benefit from the new card shadow/border treatment.

### MEDIUM PRIORITY — Global

- [ ] **Muted-foreground contrast** — Still `oklch(0.556)` in globals.css. Subtitles and labels are too pale. Bump to `oklch(0.60)` or `oklch(0.62)`.
- [ ] **Anomaly mini-chart tooltip** — Got the `chart-tooltip` wrapper class but the `contentStyle` override may conflict (sets `background: transparent`, `border: none` — needs to inherit from the CSS class, not fight it).

### LOWER PRIORITY — Nice-to-haves

- [ ] **Mobile sidebar** — No drawer/collapse on small screens. Sidebar always takes 256px.
- [ ] **Filter bar mobile** — Dropdowns don't stack, overflow on small screens.
- [ ] **Pipeline flow mobile** — No scroll-snap on horizontal scroll.
- [ ] **Accessibility** — Focus rings, aria-labels on interactive chart elements, color-independence for status indicators.

### BLOCKED

- [ ] **ANTHROPIC_API_KEY in Vercel env vars** — User needs to add via Vercel dashboard. Chat won't work in production until this is done.

## In-Progress State

Nothing in progress — clean working tree.

## Decisions Made This Session

1. **No dark mode** — evaluators will see light mode once during RFP review. Effort (~3 hrs for Recharts color audit) not justified.
2. **Rotation fix approach** — tried increasing XAxis height/margins and setting overflow:visible on SVG (both insufficient). Root cause was the `needsRotation` condition triggering for `numericKeys.length > 1` even with only 3-5 categories. Fixed by changing to `formattedData.length > 6` — only rotates when there are genuinely too many labels to fit horizontally.
3. **No contract compliance/pricing view** — dataset lacks pricing/reimbursement columns. Good domain insight from advisor but no data to build with.

## Next Action

**Start with anomaly-panel.tsx polish**: Open `src/components/anomalies/anomaly-panel.tsx`. Changes needed:

- `ChartContainer`: change `p-3 pb-5` to `p-4`
- `SectionLabel`: add teal dot matching the new `SectionHeader` pattern from process page (h-1.5 w-1.5 rounded-full bg-teal-500)
- "To Confirm" / "RFP Impact" boxes: change `px-4 py-3` to `px-5 py-3.5` for better alignment with card content
- Key stat badge: add responsive text sizing (`text-base md:text-lg`)

Then move to `before-after-table.tsx`, `follow-up-questions.tsx`, `extension-mockup.tsx` in sequence.

After anomaly internals, bump `--muted-foreground` in `globals.css` from `oklch(0.556 0 0)` to `oklch(0.62 0 0)`.
